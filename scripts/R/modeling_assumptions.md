---
title: "Modeling Assumptions"
output: 
  html_document:
   keep_md: true
---




```r
# import data
modeling_data_province <- read.csv(file = "https://raw.githubusercontent.com/francomomo/datafest-2020/master/data/cleaned_data/modeling_data_province.csv")
head(modeling_data_province)
```

```
##     X         Province       Date Score pruid Confirmed Probable Death
## 1 635 British Columbia 2020-02-16     1    59         5        0     0
## 2 636          Ontario 2020-02-16     4    35         3        0     0
## 3 638          Ontario 2020-02-21    21    35         3        0     0
## 4 637 British Columbia 2020-02-21     5    59         6        0     0
## 5 639 British Columbia 2020-02-24    13    59         6        0     0
## 6 640          Ontario 2020-02-24    17    35         4        0     0
##   New.Cases New.Probable New.Deaths Mean.Temperature Total.Precipitation
## 1         1            0          0              5.0                 4.8
## 2         0            0          0              1.4                 0.4
## 3         0            0          0             -4.1                 0.2
## 4         1            0          0              4.8                18.4
## 5         0            0          0              3.0                 5.4
## 6         1            0          0              5.8                 1.1
##   New.Cases..world. Confirmed..world. New.Deaths..world. Deaths..world.
## 1              2090             69277                142           1669
## 2              2090             69277                142           1669
## 3              1044             76817                120           2249
## 4              1044             76817                120           2249
## 5               619             79565                164           2627
## 6               619             79565                164           2627
##   Days.Since.First.Case Letter.Score
## 1                    20            D
## 2                    20            D
## 3                    25            C
## 4                    25            D
## 5                    28            D
## 6                    28            D
```

## MLR

```r
model <- lm(Score ~ New.Cases + New.Deaths + Mean.Temperature + Total.Precipitation + New.Cases..world. + New.Deaths..world. + Days.Since.First.Case, data = modeling_data_province)
summary(model)
```

```
## 
## Call:
## lm(formula = Score ~ New.Cases + New.Deaths + Mean.Temperature + 
##     Total.Precipitation + New.Cases..world. + New.Deaths..world. + 
##     Days.Since.First.Case, data = modeling_data_province)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -54.273 -10.588   0.618  11.090  52.188 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)    
## (Intercept)            5.456e+01  2.949e+00  18.497  < 2e-16 ***
## New.Cases              2.258e-02  4.685e-03   4.819 1.77e-06 ***
## New.Deaths            -7.885e-02  4.807e-02  -1.641 0.101358    
## Mean.Temperature      -6.407e-01  1.203e-01  -5.324 1.37e-07 ***
## Total.Precipitation    5.202e-01  1.152e-01   4.515 7.43e-06 ***
## New.Cases..world.      7.768e-04  5.696e-05  13.637  < 2e-16 ***
## New.Deaths..world.     1.493e-03  4.145e-04   3.602 0.000338 ***
## Days.Since.First.Case -7.472e-01  6.233e-02 -11.988  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 16.24 on 687 degrees of freedom
## Multiple R-squared:  0.4899,	Adjusted R-squared:  0.4847 
## F-statistic: 94.26 on 7 and 687 DF,  p-value: < 2.2e-16
```

## Leverage Points

```r
h <- hatvalues(model)
thresh <- 2 * (dim(model.matrix(model))[2])/nrow(modeling_data_province)
w <- which(h > thresh)
w
```

```
##   4   9  11  16  34  61 135 163 172 180 192 197 206 219 233 258 265 302 308 331 
##   4   9  11  16  34  61 135 163 172 180 192 197 206 219 233 258 265 302 308 331 
## 335 362 364 365 366 367 368 369 370 371 372 373 391 400 414 420 439 474 476 477 
## 335 362 364 365 366 367 368 369 370 371 372 373 391 400 414 420 439 474 476 477 
## 478 479 480 481 482 483 484 491 496 498 510 516 526 530 542 561 570 588 595 606 
## 478 479 480 481 482 483 484 491 496 498 510 516 526 530 542 561 570 588 595 606 
## 693 
## 693
```

```r
modeling_data_province[w,]
```

```
##       X                  Province       Date Score pruid Confirmed Probable
## 4   637          British Columbia 2020-02-21     5    59         6        0
## 9   643          British Columbia 2020-02-26     9    59         7        0
## 11  645          British Columbia 2020-02-27    12    59         7        0
## 16  649          British Columbia 2020-03-01     4    59         8        0
## 34    5          British Columbia 2020-03-09     8    59        32        0
## 61   32                    Quebec 2020-03-13    25    24        17        0
## 135 106          British Columbia 2020-03-22    75    59       424        0
## 163 139                    Quebec 2020-03-25    77    24      1339        0
## 172 142          British Columbia 2020-03-26    95    59       725        0
## 180 151          British Columbia 2020-03-27    95    59       725        0
## 192 160          British Columbia 2020-03-28   100    59       884        0
## 197 669                    Quebec 2020-03-29    87    24      2840        0
## 206 175                    Quebec 2020-03-30    87    24      3430        0
## 219 184                    Quebec 2020-03-31    73    24      4162        0
## 233 202                    Quebec 2020-04-02    87    24      5518        0
## 258 220                    Quebec 2020-04-04    69    24      6997        0
## 265 229                    Quebec 2020-04-05   100    24      7944        0
## 302 265                    Quebec 2020-04-09    86    24     10912        0
## 308 274                    Quebec 2020-04-10    91    24     11677        0
## 331 297             New Brunswick 2020-04-13    71    13       116        0
## 335 301                    Quebec 2020-04-13    96    24     13557        0
## 362 317                    Quebec 2020-04-16    79    24     15857        0
## 364 319                   Alberta 2020-04-17    80    48      2397        0
## 365 322             New Brunswick 2020-04-17    64    13       117        0
## 366 320          British Columbia 2020-04-17    76    59      1575        0
## 367 321                  Manitoba 2020-04-17    57    46       239       11
## 368 324               Nova Scotia 2020-04-17    75    12       606        0
## 369 325                   Ontario 2020-04-17    73    35      9525        0
## 370 326                    Quebec 2020-04-17    84    24     16798        0
## 371 327              Saskatchewan 2020-04-17    74    47       306        1
## 372 323 Newfoundland and Labrador 2020-04-17    60    10       256        0
## 373 334                    Quebec 2020-04-18    66    24     17521        0
## 391 352                    Quebec 2020-04-20    62    24     19319        0
## 400 685                    Quebec 2020-04-21    82    24     20126        0
## 414 361                    Quebec 2020-04-22    85    24     20965        0
## 420 370                    Quebec 2020-04-23    72    24     21838        0
## 439 386                    Quebec 2020-04-25    55    24     23267        0
## 474 415          British Columbia 2020-04-29    74    59      2087        0
## 476 424          British Columbia 2020-04-30    61    59      2112        0
## 477 425                  Manitoba 2020-04-30    40    46       264       11
## 478 426             New Brunswick 2020-04-30    48    13       118        0
## 479 427 Newfoundland and Labrador 2020-04-30    49    10       258        0
## 480 428               Nova Scotia 2020-04-30    64    12       947        0
## 481 429                   Ontario 2020-04-30    68    35     16187        0
## 482 423                   Alberta 2020-04-30    68    48      5355        0
## 483 431              Saskatchewan 2020-04-30    41    47       389        0
## 484 430                    Quebec 2020-04-30    81    24     27538        0
## 491 439                    Quebec 2020-05-01    73    24     28648        0
## 496 445               Nova Scotia 2020-05-02    69    12       963        0
## 498 447                    Quebec 2020-05-02    45    24     29656        0
## 510 456                    Quebec 2020-05-03    76    24     31865        0
## 516 464                   Ontario 2020-05-04    62    35     17923        0
## 526 693                    Quebec 2020-05-05    61    24     33417        0
## 530 474                    Quebec 2020-05-06    53    24     34327        0
## 542 483                    Quebec 2020-05-07    56    24     35238        0
## 561 497             New Brunswick 2020-05-09    58    13       120        0
## 570 510                    Quebec 2020-05-10    79    24     37721        0
## 588 528                    Quebec 2020-05-12    54    24     39225        0
## 595 534 Newfoundland and Labrador 2020-05-13    44    10       261        0
## 606 545                    Quebec 2020-05-14    44    24     40724        0
## 693 633                    Quebec 2020-05-25    36    24     47984        0
##     Death New.Cases New.Probable New.Deaths Mean.Temperature
## 4       0         1            0          0              4.8
## 9       0         0            0          0              7.0
## 11      0         0            0          0              6.3
## 16      0         1            0          0              2.8
## 34      1         5            0          0              3.5
## 61      0         4            0          0              1.0
## 135    10         0            0          0              6.0
## 163     6      1118            0          2             -0.3
## 172    14        66            0          0              5.0
## 180    14         0            0          0              5.8
## 192    16       159            0          2              6.5
## 197    22       342            0          0              3.4
## 206    25       590            0          3              1.8
## 219    31       732            0          6              2.2
## 233    36       907            0          3              4.3
## 258    75       896            0         14              3.2
## 265    94       947            0         19              4.2
## 302   216       881            0         41              0.7
## 308   241       765            0         25              1.2
## 331     0         2            0          0              5.5
## 335   360       711            0         32              6.0
## 362   630       997            0        143             -0.4
## 364    50       239            0          0              5.1
## 365     0         0            0          0              0.0
## 366    77        14            0          2             10.3
## 367     5         0            0          0              2.6
## 368     4        27            0          1             -0.7
## 369   478       564            0         55              2.5
## 370   688       941            0         58              0.3
## 371     4         1            1          0              5.5
## 372     3         4            0          0             -7.0
## 373   805       723            0        117              1.7
## 391   939       962            0         62             -0.7
## 400  1041       807            0        102              3.2
## 414  1134       839            0         93             -1.8
## 420  1243       873            0        109              0.3
## 439  1446       651            0        106              5.9
## 474   109        34            0          4              9.0
## 476   111        25            0          2              9.0
## 477     6         1            1          0             14.2
## 478     0         0            0          0              5.8
## 479     3         0            0          0              5.0
## 480    28        12            0          0              3.9
## 481  1082       459            0         86             10.9
## 482    89       190            0          2             17.4
## 483     6         6            0          0             14.5
## 484  1859       944            0         98              6.7
## 491  2022      1110            0        163              5.9
## 496    31         4            0          2              8.4
## 498  2136      1008            0        114             10.3
## 510  2205      2209            0         69              7.8
## 516  1300       370            0         84              7.3
## 526  2398       794            0        118              3.5
## 530  2510       910            0        112              6.2
## 542  2631       911            0        121              7.7
## 561     0         0            0          0             -0.8
## 570  2928       735            0        142              5.1
## 588  3131       756            0        118              3.2
## 595     3         0            0          0              1.9
## 606  3351       793            0        131              8.8
## 693  4069       573            0         85             17.8
##     Total.Precipitation New.Cases..world. Confirmed..world. New.Deaths..world.
## 4                  18.4              1044             76817                120
## 9                  37.4               927             81317                 61
## 11                 34.4              1376             82693                 43
## 16                 29.4              1880             87831                 45
## 34                 27.4              4332            113326                208
## 61                 38.0             10153            140936                442
## 135                22.0              1944            294110                160
## 163                 0.0             29810            416680               1979
## 172                26.0             54655            471335               2551
## 180                31.6             41366            512701               2353
## 192                41.6             62724            575425               3151
## 197                20.0             62705            638130               3369
## 206                11.0             59160            697290               3218
## 219                 0.0             57643            754933               3307
## 233                12.2             72901            900305               4912
## 258                 0.0             79908           1056157               6716
## 265                 0.0             80692           1136849               5749
## 302                15.0             82736           1439516               6325
## 308                 5.0             84635           1524151               7231
## 331                23.9             77274           1776837               5692
## 335                32.1             77274           1776837               5692
## 362                 0.0             76794           1998396               7908
## 364                 0.0             81839           2080235              12532
## 365                 0.0             81839           2080235              12532
## 366                 0.0             81839           2080235              12532
## 367                 0.0             81839           2080235              12532
## 368                 0.0             81839           2080235              12532
## 369                 0.9             81839           2080235              12532
## 370                 0.0             81839           2080235              12532
## 371                 0.0             81839           2080235              12532
## 372                 0.0             81839           2080235              12532
## 373                 0.0             84353           2164588               6536
## 391                 0.0             70345           2313455               5261
## 400                 7.0             83101           2396556               5238
## 414                 0.0             72107           2468663               6495
## 420                 0.0             72752           2541415               6779
## 439                 0.0             89313           2710948               5747
## 474                22.8             66321           3023671               5378
## 476                 5.0             72955           3096626               9859
## 477                 0.0             72955           3096626               9859
## 478                 0.2             72955           3096626               9859
## 479                 0.0             72955           3096626               9859
## 480                 0.0             72955           3096626               9859
## 481                 8.2             72955           3096626               9859
## 482                 0.0             72955           3096626               9859
## 483                 0.0             72955           3096626               9859
## 484                 5.2             72955           3096626               9859
## 491                23.0             85008           3181634               6399
## 496                24.6             90578           3272212               5741
## 498                 0.0             90578           3272212               5741
## 510                 2.0             83985           3356197               8626
## 516                 0.8             85984           3442181               2859
## 526                 3.0             82906           3525087               2090
## 530                 0.0             70578           3595665               4125
## 542                 0.0             83835           3679500               6520
## 561                34.0             94857           3862602               6464
## 570                 0.0             89086           3951688               4605
## 588                 1.3             81413           4121785               3524
## 595                16.8             75740           4197525               4332
## 606                 0.0             82566           4280091               5037
## 693                 0.0            102660           5333415               3527
##     Deaths..world. Days.Since.First.Case Letter.Score
## 4             2249                    25            D
## 9             2771                    30            D
## 11            2814                    31            D
## 16            2986                    34            D
## 34            3992                    42            D
## 61            5362                    46            C
## 135          12944                    55            A
## 163          18573                    58            A
## 172          21124                    59            A
## 180          23477                    60            A
## 192          26628                    61            A
## 197          29997                    62            A
## 206          33215                    63            A
## 219          36522                    64            A
## 233          45624                    66            A
## 258          57130                    68            A
## 265          62879                    69            A
## 302          85709                    73            A
## 308          92940                    74            A
## 331         111828                    77            A
## 335         111828                    77            A
## 362         131034                    80            A
## 364         143566                    81            A
## 365         143566                    81            A
## 366         143566                    81            A
## 367         143566                    81            B
## 368         143566                    81            A
## 369         143566                    81            A
## 370         143566                    81            A
## 371         143566                    81            A
## 372         143566                    81            A
## 373         150102                    82            A
## 391         162264                    84            A
## 400         167502                    85            A
## 414         173997                    86            A
## 420         180776                    87            A
## 439         192965                    89            B
## 474         213339                    93            A
## 476         223198                    94            A
## 477         223198                    94            B
## 478         223198                    94            B
## 479         223198                    94            B
## 480         223198                    94            A
## 481         223198                    94            A
## 482         223198                    94            A
## 483         223198                    94            B
## 484         223198                    94            A
## 491         229597                    95            A
## 496         235338                    96            A
## 498         235338                    96            B
## 510         243964                    97            A
## 516         246823                    98            A
## 526         248913                    99            A
## 530         253038                   100            B
## 542         259558                   101            B
## 561         271435                   103            B
## 570         276040                   104            A
## 588         284254                   106            B
## 595         288586                   107            B
## 606         293623                   108            B
## 693         343115                   119            C
```

## Influential Observations

```r
# Observations
n <- 695

# Predictors
p <- 7

# Cooks' Distance
D <- cooks.distance(model)
which(D > qf(0.5, p + 1, n - p - 1))
```

```
## named integer(0)
```

```r
# DFFITS
dfits <- dffits(model)
which(abs(dfits) > 2*sqrt((p + 1)/n))
```

```
##   1   2   4   9  11  16  34  61  87 134 135 136 140 141 142 163 172 180 192 258 
##   1   2   4   9  11  16  34  61  87 134 135 136 140 141 142 163 172 180 192 258 
## 372 474 482 498 506 510 561 570 636 679 680 683 684 687 
## 372 474 482 498 506 510 561 570 636 679 680 683 684 687
```

```r
# DFBETAS
dfb <- dfbetas(model)
which(abs(dfb[,1]) > 2/sqrt(n))
```

```
##   1   2   3   4   5   6   7   8   9  11  13  15  16  17  19  23  30  31  41 121 
##   1   2   3   4   5   6   7   8   9  11  13  15  16  17  19  23  30  31  41 121 
## 146 148 149 154 160 164 168 181 185 193 205 209 216 267 306 307 474 510 561 594 
## 146 148 149 154 160 164 168 181 185 193 205 209 216 267 306 307 474 510 561 594 
## 636 645 680 683 684 687 
## 636 645 680 683 684 687
```

## Check Assumptions

```r
resid <- rstudent(model)
fitted <- predict(model)

# Normal QQ Plot and Standardized Residuals Plot
par(family = 'serif', mfrow = c(1,2))
qqnorm(resid)
qqline(resid)
plot(resid ~ fitted, type = "p", xlab = "Fitted Values", 
     ylab = "Standardized Residual", cex.lab = 1.2,
     col = "red")
lines(lowess(fitted, resid), col = "blue")
```

![](modeling_assumptions_files/figure-html/unnamed-chunk-5-1.png)<!-- -->

```r
# abline(lm(resid ~ fitted), lwd = 2, col = "blue")

# Response vs Fitted values
par(family = 'serif')
plot(modeling_data_province$Score ~ fitted, type = "p", xlab = "Fitted Values", 
     ylab = "Score", cex.lab = 1.2,
     col = "red")
abline(lm(modeling_data_province$Score ~ fitted), lwd = 2, col = "blue")
lines(lowess(fitted, modeling_data_province$Score), col = "red")
```

![](modeling_assumptions_files/figure-html/unnamed-chunk-5-2.png)<!-- -->











